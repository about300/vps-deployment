<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VPS Dashboard - 全栈服务管理</title>
  <meta name="description" content="离开世界之前 一切都是过程">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

<!-- ================= 导航栏 ================= -->
<nav class="navbar">
  <div class="container">
    <div class="nav-brand">
      <i class="fas fa-server"></i>
      <a href="/">VPS Dashboard</a>
    </div>
    <div class="nav-menu">
      <a href="/" class="nav-link active">首页</a>
      <a href="/subconvert/" class="nav-link">订阅转换</a>

      <!-- 重要：给默认可用 href，JS 再覆盖 -->
      <a
        id="sui-nav-link"
        class="nav-link"
        href="http://127.0.0.1:2095/app"
        target="_blank"
      >
        S-UI 面板
      </a>

      <a href="#services" class="nav-link">服务状态</a>

      <a href="https://github.com/about300" class="nav-link" target="_blank">
        <i class="fab fa-github"></i> GitHub
      </a>
    </div>
  </div>
</nav>

<!-- ================= 头部 ================= -->
<header class="page-header">
  <div class="container">
    <h1 class="page-title">VPS 全栈服务</h1>
    <p class="page-subtitle">离开世界之前，一切都是过程</p>
  </div>
</header>

<!-- ================= 主体 ================= -->
<main class="container main-content">

  <!-- ===== 搜索（直连 Google）===== -->
  <section class="search-section">
    <form
      class="search-container"
      action="https://www.google.com/search"
      method="GET"
      target="_blank"
    >
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input
          type="text"
          name="q"
          placeholder="直接使用 Google 搜索"
          autocomplete="off"
          required
        >
        <button type="submit" class="search-btn">搜索</button>
      </div>
    </form>
  </section>

  <!-- ===== 快速访问 ===== -->
  <section class="tools-section">
    <h2 class="section-title">
      <i class="fas fa-rocket"></i> 快速访问
    </h2>

    <div class="tools-grid">

      <a href="/subconvert/" class="tool-card">
        <div class="tool-icon">
          <i class="fas fa-exchange-alt"></i>
        </div>
        <div class="tool-content">
          <h3 class="tool-title">订阅转换</h3>
          <p class="tool-desc">支持 Clash / Surge / Quantumult X 等</p>
          <div class="tool-meta">
            <span class="tool-tag">在线</span>
          </div>
        </div>
      </a>

      <a
        id="sui-card-link"
        href="http://127.0.0.1:2095/app"
        target="_blank"
        class="tool-card"
      >
        <div class="tool-icon">
          <i class="fas fa-tachometer-alt"></i>
        </div>
        <div class="tool-content">
          <h3 class="tool-title">S-UI 面板</h3>
          <p class="tool-desc">节点管理 · 用户管理 · 实时监控</p>
          <div class="tool-meta">
            <span class="tool-tag">管理</span>
          </div>
        </div>
      </a>

      <a
        id="adguard-link"
        href="http://127.0.0.1:3000"
        target="_blank"
        class="tool-card"
      >
        <div class="tool-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="tool-content">
          <h3 class="tool-title">AdGuard Home</h3>
          <p class="tool-desc">DNS 去广告 · 隐私保护</p>
          <div class="tool-meta">
            <span class="tool-tag">安全</span>
          </div>
        </div>
      </a>

    </div>
  </section>

  <!-- ===== 服务状态 ===== -->
  <section class="services-section" id="services">
    <h2 class="section-title">
      <i class="fas fa-heartbeat"></i> 服务状态
    </h2>

    <div class="services-grid" id="services-grid">
      <div class="service-card loading">
        <div class="service-icon">
          <i class="fas fa-spinner fa-spin"></i>
        </div>
        <p class="service-text">正在检测服务状态...</p>
      </div>
    </div>
  </section>

</main>

<!-- ================= JS ================= -->
<script>
/* ---------- 安全设置 S-UI / AdGuard 链接（双保险） ---------- */
document.addEventListener('DOMContentLoaded', () => {
  const host = window.location.hostname || '127.0.0.1';
  const protocol =
    window.location.protocol === 'file:' ? 'http:' : window.location.protocol;

  const suiUrl = `${protocol}//${host}:2095/app`;
  const adguardUrl = `${protocol}//${host}:3000`;

  const suiNav = document.getElementById('sui-nav-link');
  const suiCard = document.getElementById('sui-card-link');
  const adguardCard = document.getElementById('adguard-link');

  if (suiNav) suiNav.href = suiUrl;
  if (suiCard) suiCard.href = suiUrl;
  if (adguardCard) adguardCard.href = adguardUrl;

  checkServices();
});

/* ---------- 简单在线检测（不展示端口） ---------- */
async function checkServices() {
  const grid = document.getElementById('services-grid');
  if (!grid) return;

  const services = [
    { name: 'Web 服务', url: '/', icon: 'fas fa-globe' },
    { name: '订阅转换', url: '/subconvert/', icon: 'fas fa-exchange-alt' },
    { name: 'S-UI 面板', url: document.getElementById('sui-card-link')?.href, icon: 'fas fa-tachometer-alt' },
    { name: 'AdGuard Home', url: document.getElementById('adguard-link')?.href, icon: 'fas fa-shield-alt' }
  ];

  grid.innerHTML = '';

  for (const svc of services) {
    const card = document.createElement('div');
    card.className = 'service-card loading';
    card.innerHTML = `
      <div class="service-icon"><i class="${svc.icon}"></i></div>
      <p class="service-text">${svc.name}</p>
      <p class="service-status">检测中...</p>
    `;
    grid.appendChild(card);

    try {
      await fetch(svc.url, { method: 'HEAD', mode: 'no-cors' });
      card.className = 'service-card online';
      card.querySelector('.service-status').textContent = '运行中';
    } catch {
      card.className = 'service-card offline';
      card.querySelector('.service-status').textContent = '不可达';
    }
  }
}
</script>

</body>
</html>
